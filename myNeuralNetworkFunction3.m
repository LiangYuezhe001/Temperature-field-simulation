function [Y,Xf,Af] = myNeuralNetworkFunction3(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 22-Feb-2023 19:09:23.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx6 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx6 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [500;293.144849076321;378.920360263247;293.17428325308;293.176745303054;293.153340844143];
x1_step1.gain = [0.01;0.00439772283000273;0.00402194105125515;0.00639228745212392;0.00575213213162391;0.00916893551928536];
x1_step1.ymin = -1;

% Layer 1
b1 = [-6.7861330651217652843;5.7302704553180134894;-5.4950708003032122662;-2.2697329943545727637;2.6159661501626807478;-0.75288940931034786797;0.48378531301959115662;-1.7994106490895436234;2.6725067306840855075;-0.22876032430413251184;1.8339286139342660942;0.57455933710812134851;-0.64169363961525216489;0.8171150500630939284;1.3527009369907219138;-0.99548406434136160748;-0.44331735392485410729;0.1004560560062496416;-1.5713156301837056805;0.087848039626351154263;0.50700793917756314944;2.1553187053921347704;-2.0174262503190405482;1.0838792003018378196;-3.2722089730461623169;1.272848530914996168;3.3836152383628514961;-2.0939095058826282525;1.2248064576472716958;7.2068921792648321656];
IW1_1 = [-0.013213961904284001608 -2.4645093041424144253 1.0867003687067315898 -2.1817292565678463312 0.13528353481334198793 -0.87261539390772158153;-0.49820310836668496579 -5.1598231946565231709 -3.2162237216537876705 -7.0094611120299346041 1.254975427375762731 -1.0232669336290753925;0.4643048243647154294 3.7485770824907453935 3.86548123048923431 8.161147800611091796 -1.8365872177687596611 1.0748461110978795308;0.15294105438781083195 0.72763131333597397266 -1.5371453209923320316 0.59292559605193118077 5.1427180729362884648 -3.0023930483999259344;0.26438142516983603736 -0.18488843872594154516 3.8549071923259901062 -2.2351800301219761913 -0.91920096159806219394 -1.9764948543803568803;-0.25968576873393578452 2.1630830182241815862 -0.72803035511888336551 2.0442657430969131127 -3.0129168323216299896 1.3925056846461374427;0.1967467607049500633 0.0063253253552897036049 -3.8139530801656889025 9.8396890136349224321 -1.9687381336849922864 -6.5524533652206349288;1.2037827669867939839 0.92136338679483231751 2.9153327566751343625 -1.9497491110779194834 -3.6651796554990179189 -2.0085091013601834575;2.2221174770280751609 1.6886816049787880534 -3.2296937753586143494 1.27090531121832373 -0.32549202788704839628 -1.4970338726214029723;-0.20317669380164310455 -1.2868836167373289836 1.2298513864403792795 2.1245115055454046882 -1.5624382186120615579 0.79121399542477854894;-1.8630979809427297145 -4.2683393030591183503 3.5160118056899003491 -0.17067646466130539928 -0.60619385989494845024 1.5703408608444324734;-1.2379068589428412483 0.17077220603880038929 -0.074484057906207948307 3.723823403202945137 -5.3879444987366511555 2.0003799901306242859;0.020947779850472861979 0.95743192715367930745 -1.0077281414727352615 -0.78398606444074003807 0.17104786807979244223 0.21205440267182767977;-0.26488298036597507368 3.3882260360185214587 1.0900224594429444025 -2.5316962128870943438 -2.4641168452167749869 3.6258888235890580631;-0.40903666759415019394 -0.82191298898587250576 0.94610552315877560758 -1.0089209777389704925 0.58252676146820503433 0.26286291037559678108;-0.28180053184025438684 -0.71556691412607120739 0.47276063062440376594 0.52130591856468644352 1.6436241458004581251 0.76868936482747773908;-0.63977669709187856562 1.5240043209742444308 -2.6669524975897647145 1.0508910432960754111 -4.2504125765317626318 2.1940543387266471242;-0.095465585063436581015 -1.3201962465496364096 1.3557980914769713898 1.7227019862064429923 -1.0926484103967379902 0.35955145281786055067;-0.6225929005089668733 -3.8390765661545405152 -1.1434802089805136127 -4.9963699569742088258 8.146757444548406113 -0.76534945235451079526;-0.37561173958717208876 -0.44953571264471209323 0.64466888449940407124 1.2047734892310097976 -0.81958534480525102595 -0.07599000242546131989;0.067891927486031455885 -3.9264697530599250719 -5.7996523803401442976 1.2417418028079598713 8.9753390862976889508 -5.325345355505149314;-0.26184908203640655522 1.1580583141316744822 3.3653365930960883468 0.73857946459824885821 -0.23485712589742546719 -1.4452738034292307301;-0.013474237473108798685 0.52999034280879420145 1.3043968991847085803 1.3514847666549625327 -2.1503729305439560626 1.4495357443225957983;-0.51283117852621662447 0.40529853378415048315 -0.40626051546195307562 2.1095493531101405793 -3.7604887341385873079 2.2585861139579233026;-3.2645699439437212419 5.3619372477575870661 0.62050165266142920384 -0.74722617224472809294 -6.0600509939112514601 7.3059259392285724743;1.5207552812714941748 -1.4594432342424905613 -1.3146201876854100021 0.53655832330012143139 0.1435288615940049084 3.6252975397804405588;2.6122152278910633072 0.87931731544790459054 -0.99619358784951672625 -2.351762854024421312 1.0618020003339057045 1.084413788777923271;-0.66303191087601032194 2.8471663660523600647 -1.8569334963213446343 0.88444289125113872974 -1.9259447490342040954 -0.75471681801587886529;0.41014287597711884814 -4.8895113974297030879 1.1285408389551709885 3.191602387807450647 3.2808570503479193015 -5.1358034910643706183;1.5135851168962319857 -1.5264291713197040146 3.1111862261670326646 -0.86877106778635349027 -0.37096806565288586999 -2.7412182293368867469];

% Layer 2
b2 = [-0.71651721325466788404;0.37866694544981249759;-0.87047559302293597838;3.0793603568962093497;-0.32473572396200578449;-0.60806982398508235832];
LW2_1 = [-2.82940282119162001 -0.14588953775667060087 -0.14774218148547921259 -0.045361503788022478068 -0.015220694829791717867 0.29608409034243943214 -0.010113772447967770557 0.065210996915202795732 0.079396315227154318217 -0.5065798064749907903 0.26407553787206078377 -0.15191464536518523021 -1.1954646533704103017 0.043547231252943990887 -2.8040910860420660278 -0.058870985832065500509 0.028085978757228170083 0.84706910274823232765 -0.038210987688988701239 -1.7717017398972039199 -0.017897323243529297127 -0.1081917280785911345 0.25101488881918465612 -0.41737765971799511977 -0.00077856508900316437338 0.030812379475010070323 0.12288005736352078379 0.045392482344471164757 0.065948621799721829362 -0.10072162894240856146;1.0237284443547529644 0.029974661461858863321 0.026208947905719877369 -0.020738565686903132068 0.049693700508701234286 0.45003370676194109912 -0.10714411960875032392 0.037212631215119348904 0.23694879886258241042 -0.90684652170807888982 0.034971901612797166858 -0.015462967629430581645 -1.372134578804015792 -0.0017452586603063538311 -0.33922731112544990406 0.039028591852748345525 0.0063700291602975687641 0.8332446621678372134 0.019672774923926474033 0.012303911623147185603 -0.021354320329275852663 -0.0028125252947018546806 -0.079393223259202908015 -0.030394284241391116008 0.014715568023329513719 -0.00068774918779976367336 -0.061099328156173762783 -0.036939030137069360504 0.083242351849775741979 -0.09331964353070049123;-1.9417811280625885129 3.5558859177061745704 3.6794902826614297453 0.17747606456608416847 -0.12095749880871929649 -0.023676081246639876787 -0.022829844614286418786 -0.067825798254661992526 0.46326569601252881592 0.44777845532196358658 -0.27076629294716880736 0.37593562982667022565 -3.5661582239212141765 -0.024337890491210614763 1.7025531265812638981 -0.019317063343458437674 -0.12944372603414097678 -1.6201501211621336385 -0.1692054963733438111 -0.33859073448808818529 0.0040545601566524111167 0.042879391636561250967 0.12226711752731166116 -0.76653291601157624857 -0.044734414490663704234 0.07045441052876393051 -0.34419374618830450574 0.030981409015880624624 -0.050435531206218998934 -3.2809156870750761925;3.437711094972496717 0.046859074144433035536 0.047702371752927380522 -0.052620839251428186412 0.022690260198817056858 0.38555804707374452533 -0.069069395442121706008 0.029843013228187626612 0.014079414650208753323 0.1134558763081215671 0.07670328412748864122 -0.095179617212656483782 -3.2573426741279836172 0.14380945621026966497 -0.1553720907228847703 -0.0039695389858887732831 0.018269021565447168126 -0.93632921093925469691 0.047836578855448876058 -0.19796300364574204167 -0.0060180928845674514643 -0.11016079946100321152 0.056131625888591843432 -0.026277404606868302872 0.015245491065497985411 0.0095191268263751377399 0.13677619120728806701 0.21481475889909934507 0.089393059446265424328 -0.8722934386638337978;-0.19491436827755784233 -0.0083311303679900420432 -0.0077571716162661875915 0.040723106371686988714 -0.016222771560473577684 0.67182047962124535889 -0.1008353595166802813 0.066661626597783116277 0.054289940166367046948 -1.061095048468526425 0.201233581579038312 -0.12007594199723901907 -2.3321347857116738744 0.015130164634641170979 -1.1431628547221905912 -0.021426846821827057188 0.03066456380532217238 0.54611614855957646419 0.077144247405714003185 -0.025722416045796399342 0.019167305002900234673 -0.043192122593499575334 -0.17672824012489884993 -0.0567961817419229964 0.024635225654687863128 0.029036713299287867512 0.01782840690476716547 0.26849684955568986489 0.053600756165895824257 0.033816389502727889349;-0.89956426452050797238 0.044410211173878486046 0.044768163749785795658 0.046384324506155982792 -0.0089143816789868206285 0.60691663085152880441 -0.062368439536916842059 0.063909630790282362378 0.058123081225587382159 -1.7553432015228729313 0.18063700204765401058 -0.14029550173817648129 -1.1745899731702149626 -0.08959612096815311455 -0.98761684969226659625 0.04543821737479045858 0.018108348819738960545 1.4627387601163501785 0.025143578212110599679 0.23247589825892212012 -0.0030610373809003285986 0.047821794712243827219 -0.031889098856679953808 0.00036000290416283303729 0.021410326596546989247 0.013582146947371892542 0.022021572272194759462 0.073275246150123846123 -0.00044063679075817194231 -0.27535803549741677543];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.01;0.00339124915383859;0.00343265376238828;0.00337483483108877;0.00340561764119074;0.00339064219502096];
y1_step1.xoffset = [500;383.422134772947;390.510423420735;380.203339952262;385.88674279854;383.293566401332];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);

    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);

    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;

    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
