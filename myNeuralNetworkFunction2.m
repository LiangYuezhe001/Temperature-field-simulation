function [Y,Xf,Af] = myNeuralNetworkFunction2(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 21-Feb-2023 20:42:23.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx7 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx7 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0;293.128780218587;339.20156980438;293.342217226859;293.208487258245;293.396243236214;500];
x1_step1.gain = [0.02;0.00652635639596589;0.00381493024013456;0.00831777714187804;0.00658162189514473;0.00871829641918878;0.01];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.970114507400050341;2.0774246697395892802;1.6775595288591618193;1.2276195429985654606;-1.240710223632573328;1.3522821001146654307;1.4577922584689049224;-2.5990359972722649751;-2.199719543921996312;0.38811466750410100746;-1.389642244614326172;-1.0847870704838875611;-1.6892562303784162125;-1.3016216461369485291;0.23505364434666381479;0.11949490824707362235;-0.069838931473084481238;0.5550609608604107903;0.35284316815202465545;-0.87189825206559723458;-1.2497389921423123216;1.1519497516515488922;0.2246266050487034649;-0.8993224242062006768;-1.556630301449630549;-0.52277122791079411179;-1.8033906814357314463;1.3597630370861897298;1.1787180051610532949;0.90717424055972595287;-0.50609616858110162418;1.2760334541562139421;-1.1459090944116143707;-1.8743683087057347869;-1.4402683401037752464];
IW1_1 = [-0.49159155814298166609 0.91689026497961156892 0.47831776268411291264 -0.55760312581176751934 -1.1318613902056720022 1.3090719733863636076 0.19675701272474924175;-0.21402375110811067138 -0.87126733776238163287 1.6959187500472672205 0.99809114433136292277 2.373348141775874609 -1.405689267412631116 1.1754357240983177579;-0.4170758604013876103 -1.167325781769029458 1.3771897880260184355 1.1946137418154401111 -0.82477081619782621758 0.50903533893716235159 -0.20332640354023126528;-0.27583933160937457174 -0.17277703204496239198 0.21994882776642207811 1.0933109585357836391 0.76232690362374233572 1.3701695404192801853 -0.10566680962178078007;1.1197443344451676328 1.2261991276213504154 -0.10739889532188848231 0.38176182930705032659 -0.54335626884217003152 -1.7879669255172081499 -1.2072315653323626439;-0.43287576357936863314 1.2063553574074135089 -0.61088245458509393693 1.0427991350677443538 0.95899976170343825821 -0.61992314091341493842 0.87311131354926507786;-1.0446960174831367851 -0.33525961848849189506 1.0041190220344302642 0.26181252305082858278 1.48773220000861639 -1.6198144349422807231 0.96828755134900290624;-0.057539590694467381005 -0.12360470071404021375 0.76255256627873380104 0.0352448594289055811 -0.081177755981899940574 1.1938273408089141725 0.52691444163962009029;-0.08431228761131957794 -1.1985668314290145453 2.9891988913228400015 1.3431368513461439118 1.343171210407517524 0.75276172118436956993 2.1637693579306276348;-0.63298780627548778543 1.1526853664904888053 -0.95508865551436594732 0.23657055265992393833 0.14802643249982824769 -1.8633292102110505795 -0.20811665387786781878;0.62042747812564380538 0.8951328746998072905 1.3652231951558722045 0.70306456568640940397 2.0975388809222899056 0.025816675803059779132 -1.0824790259734724529;0.47731031620765429491 -0.71577918215285651904 -0.051119168046311093401 -1.071347916036074821 -1.1853404218231939904 0.027964779059286997559 0.040616895511143252806;0.33023611847344025438 -0.19414606547803453518 -3.15632864090852161 -0.38242502402371497672 -0.86749569948990334911 2.101277020103857307 -0.50758712691042273679;0.75324935739688292369 1.7913905701332195619 -0.3969536129897828225 -0.052117743789094492235 0.52163556187349424675 -0.98906314530441175048 -1.6795847222523423437;-1.2409216240365075201 0.11897298222949860558 -1.9604740097558408518 0.92765422814488185388 -1.0465356404138757007 -1.7094941519377537809 1.0723678665793838771;0.94088192117763536082 0.67076481536640308878 -0.70273332515267616927 1.3464750840258490339 -0.70892176129012363095 -1.009156352033523385 0.15081286616239217291;0.071001528287831364161 1.5527355435269685202 -1.1039442771949561362 -0.99679316896201375364 0.49042845974436455325 -0.91534518311179258188 -0.48437179058610002613;-0.63222616132426168178 -1.2491765201352751369 -1.8094098209094671148 -1.3496313589087167717 0.93922039206452856419 -1.4885437917746098258 0.35249061923941865659;-0.16296300684479617105 -0.10912326506406688775 -0.79521562614154683857 0.66729664443095082493 -0.38290967760591165803 -1.8364342100756299025 0.5402205727379018052;0.43879691106140533696 -0.64894283829377863437 -2.1014477691954320804 0.077213781828575092647 0.28216433615326380613 1.1097147480066864578 -0.28519492297742438103;-2.4262771153466569096 -0.8812062692388528129 -0.61456342056741208868 -2.4792303037616956196 2.5699136516310514544 0.37650857344081190003 0.94093165985887750047;-0.48249757143182242514 3.1128426271206768305 0.61258828757648375873 0.030250742407350525442 -2.017317168104491909 -2.3826541941261720758 0.59363932407931685464;-0.086548959203761224868 0.5474055618521909139 -1.1214500358587633499 -0.68015403991845979625 -0.34377605836277086437 1.0353392391746780721 -0.55475506604040669689;-0.78740127054270592222 0.59062744020812818491 -1.1404634045249777419 -0.88780478958649466925 0.35439335347801809162 -1.7222375042609574525 0.69683077049373431944;-2.4033454510496969903 -0.47409829859524932338 0.00079270662191836534054 -0.62306349609743538753 -0.43812862165224830679 1.6653458433793713045 -0.69834048805498682988;-0.51195733492598760606 0.79388890439726422787 0.51020303908645781021 0.67978443156463663755 0.14114388786162460065 -1.620557394061855172 0.49339459392191598042;-1.9913733718356680935 -0.25093878683067349922 0.52798244024780549566 -0.67780628944757426169 -0.87008553078526751356 2.2561041471805913794 -0.04929753105645982153;0.65322885806277197762 -2.095286894278426626 0.62450712136921815443 1.6494843089039574746 -0.035061428311924082435 -0.24933302544148952529 -0.82479988681609539558;0.3957402562553616332 -1.5010793124810908328 -0.97950826359369558283 -0.54763252616340951651 -0.59416143700051693433 1.3217562217954184067 -0.51000696459161809493;-0.50824565857343539932 -0.17986780381984771027 -1.5019361011400642614 -2.589013384620114433 0.57217196807836645522 1.5070794883357312433 0.79285880453913082366;0.2240059754586087859 -0.90428935431549184454 -0.060702441182245256424 -0.080571381064539343564 1.246063743590183126 -0.79819319164721502791 -0.35237964017326878219;1.6970851428052011745 1.9920765770110542281 1.0532699233028817165 1.4523808893630385519 -3.0927840442904428464 -0.0036470818960786560887 -0.2336803788598223186;0.92875982114315291938 3.1514878806498205499 0.57928083080758929757 1.3584654209083943943 -0.32559624246874707687 -0.39354444797337162498 0.041984309691670315678;-1.3654942749129430624 -0.58524326002572213401 -0.60503099521153047569 -1.7155957343687244787 0.45229293423470767754 -0.022105161904093874325 -0.1709685445499897205;-0.71674198874218175703 0.33552515557500178778 0.4472726488501841402 0.41086959754477664353 0.11445043239444950556 -0.32177134868752332864 -0.06315794044071215696];

% Layer 2
b2 = [0.58589257355957791162;0.81295114998949180585;1.0547941674543173107;-0.078604320707599442675;0.21036714440251513825;-0.17234399154072235771;0.95260806155746324819];
LW2_1 = [-1.2059239640450891695 -0.21995593668838270274 -0.61101062643457437762 0.6918558591929176993 0.029128405338990887019 -0.63148588919403125796 0.75095118011245487466 -0.11468038384902952409 -0.040092783112802926615 0.16540226554238302015 -0.051266833923596828726 0.61662401344724415697 0.69264145458612069728 0.0099308966976786629266 -0.13795691404944371294 -0.10365731898087683638 0.010597340313845404758 0.10157808775665805312 -0.23972346134819166874 -0.25130909108010218711 0.037298859875576149958 -0.40877259542339444698 -0.16548274940031018621 0.1608939049501583729 -0.13692925092444341306 0.024944508656712053446 -0.32347654974354816959 -0.074240070802762292423 0.039586644726380834647 -0.019295598772011451905 -0.79420671314382651484 0.090109495033743963743 -0.10761716734256418504 -0.62367570385664838906 -0.21299610295936108328;0.5896975579680925339 0.16862537907049249264 -0.53448794682768585584 0.24461835524933367436 0.082489763033651353208 0.24198733273840983271 -0.29644162148911168408 0.2007267193681989137 0.051473538989510868313 -0.20500190035192711324 -0.0080209782729775448706 0.22680627781499682061 0.060444704412336222599 -0.04373585863146036562 0.062401961903302112511 0.2102440587644209824 -0.012647653119656302248 -0.051830056635621839234 -0.029017553149365365311 -0.5026641562321697565 -0.055456419880147281298 -0.48493572213872898624 0.62517378479131935354 -0.062634153798533723223 0.059977566356748737708 1.1857851029428854162 0.24767183325703892582 0.22252444854454728196 0.22105979293875355207 0.073038582312975275368 0.11930896888404547707 -0.031899429441216153869 -0.10851802956067894967 0.77736889181342605504 0.13089596787697319047;0.31949260381795485664 -1.3339639017060176407 0.46139301770405793945 0.10948211222614397109 -2.5400578123673618336 -1.3175861639359864874 -1.0546233213341864587 -1.3309731638392159336 -0.68604120476376917459 -0.70952419686905443541 -0.38924112287256878995 -0.22662375532110817788 1.0728370774455249226 -0.56604334159819824634 -0.92620009934664271345 -2.5890885303891906233 -0.13089949077667212274 0.88469530586311195819 0.36410327003894227271 1.4585257508891074085 -2.2186793701003169055 -2.2754828221044514081 -0.7814859686835604613 0.26332711989099388816 1.8551866449207188303 1.5977127210088442055 -2.6679401046676893827 -1.4967833115744206829 -2.5730981006996098692 1.2344514484491087014 -1.609748061192137536 -1.7699073605543487187 -0.26213903903572682852 -1.0919621137999633298 0.3515573015006900337;-0.028631109284230144701 0.0061021117780074487363 0.054977576303180550332 0.10108721052614473568 -0.28064347219656488042 0.31315637838300869333 -0.67432350174558708389 0.82726312419763281536 -0.027888180074075719778 0.53592233083591123144 0.020552301769052060132 0.13629520781695353415 -0.37012186286993370432 -0.030501993323526436358 0.036605095918302146818 -0.69853585416182562007 0.48693778326337189277 0.081879579616534969855 0.017800997469093523401 -0.44052822167796484853 -0.052581612842014402442 -0.22656841439837985264 -0.56795305435327303467 0.12998483748851441533 -0.27472607162480089382 -0.02921370960437118941 0.43837419926672510639 0.18650154025764612009 -0.52629931223535519891 -0.19721768436261583046 0.11864802859685665004 0.20428475199339740653 -0.026648728120920422979 0.20198018842328463451 -1.2671547653890933294;0.044064002682374904529 -0.24821200090373959912 0.093358272384095886132 -0.28761471274221023231 -0.51514663971785457086 -0.29488325478721139072 -0.317967703644085109 -1.2064887554172101236 -0.096298514395032466795 -0.90221877348381518402 0.16875572378666442441 -0.35113852200416284521 0.67915861620281126054 -0.23280148803732164664 0.29720046419860213227 0.43278593702708845203 0.77021905975515769782 0.38160885965537300057 -0.63592750538382025738 -0.82390902620052208771 -0.30195045439487744332 -0.97939234624918047878 -0.29535814081956462962 -0.20323012472454965449 0.31736943996526539857 1.076997633580063729 0.19699048003719224487 -0.09730619374232117591 -0.071135353143951765564 -0.22491455340291496845 -0.90290796265521988673 -0.41460458995546733973 -0.20237759579283282063 0.55060870693086505501 -0.58942273092530372836;0.34492494279869778673 0.41627125789693497637 0.12911472713740368423 0.585498314982721757 0.11083273022623890691 0.76984671954559780183 -1.0436405727870485816 -0.3346329809260488175 -0.0030441668737817709559 0.064881477461829220599 -0.082441531587604921505 0.66323143054327515777 -0.44708264359388510956 -0.21496153258718841972 0.043608679335757259687 0.19305221727983443158 1.0693564473145134031 -0.12932046958942799986 0.28818953223686499809 -1.0589753118884739358 -0.38042847299744997347 -0.64925625734584802018 -0.82668261437858747698 -0.05166147099514598745 0.14140303068391713026 0.262886190994619795 0.61849867328129448651 -0.099818456809887920467 -0.46709776871651947916 0.29030417492560628423 0.83465761121873027761 0.02090009319016664785 0.077607395451557051325 0.63532145763754643841 -0.72165796412592142506;0.8624934837207433036 0.44243660497426695599 -1.0663289153481527727 0.13441842871687187388 0.29791350696513146934 0.56569435105075138726 -0.64870646041797308534 -0.17705669240880486659 -0.016558568625886123382 -0.89048622815580857903 -0.10041844287262835511 0.26400848031817125694 -0.55123152105727213357 -0.2087137589940037119 -0.21776245779908778855 0.78381200788262661572 0.31629438208899868235 -0.20384019684979656772 0.49066592094467842422 0.062489507176140317302 -0.19136647025905614838 0.06728034835122988222 -0.34886394139174081719 0.043432684910744569218 0.010555703493888572014 0.44898911927086643248 0.19876710926712476413 -0.31476952495162263679 -0.022322293738555536169 0.30410761676368042172 -0.32012948117944761695 -0.50573625344091777123 0.11204544223500856326 0.49164429484200516951 0.14428282103469708408];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.02;0.00317280126396352;0.00318504989790623;0.00316189796662253;0.00317506325014803;0.00316798543322645;0.01];
y1_step1.xoffset = [0;342.657543210678;345.224871324331;340.381489450361;343.273851536406;341.887196896676;500];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);

    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);

    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;

    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
